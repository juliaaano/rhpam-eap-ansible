---
- name: create {{ rhpam_server_data }} directory
  file:
    path: "{{ rhpam_server_data }}"
    state: directory

- name: add kieserver api user {{ rhpam_server_api_usr }}
  command: "{{ rhpam_server_home }}/bin/add-user.sh -a --user {{ rhpam_server_api_usr }} --password {{ rhpam_server_api_pwd }} --role {{ rhpam_server_api_roles }}"

- name: add human user {{ rhpam_server_human_usr }}
  command: "{{ rhpam_server_home }}/bin/add-user.sh -a --user {{ rhpam_server_human_usr }} --password {{ rhpam_server_human_pwd }} --role {{ rhpam_server_human_roles }}"

- name: create {{ kie_maven_settings_custom }}
  template:
    src: settings.xml.j2
    dest: "{{ kie_maven_settings_custom }}"

- name: create setup.cli
  template:
    src: setup.cli.j2
    dest: "{{ rhpam_server_temp }}/setup.cli"

- name: run setup.cli JBoss configuration
  command: "{{ rhpam_server_home }}/bin/jboss-cli.sh --file={{ rhpam_server_temp }}/setup.cli"
